<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Home Rent - Departamentos en Airbnb</title>

  <link rel="icon" href="/favicon.ico" type="image/x-icon">
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<style>
    .fade-in { animation: fadeIn 0.8s ease forwards; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
  
    #popup, #lightbox {
      opacity: 0;
      pointer-events: none;
      backdrop-filter: blur(5px); /* EFECTO BLUR */
      transition: opacity 0.5s ease;
    }
    #popup.show, #lightbox.show {
      opacity: 1;
      pointer-events: auto;
    }
  
    #popup-content {
      background: white;
      padding: 1.5rem;
      border-radius: 1rem;
      max-width: 600px;
      width: 100%;
    }
  
    .popup-thumbnails img {
      border-radius: 0.5rem;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    .popup-thumbnails img:hover {
      transform: scale(1.05);
      box-shadow: 0 4px 14px rgba(0, 0, 0, 0.25);
    }
  
    #lightbox-img {
      transition: opacity 0.5s ease;
    }
  
    .lightbox-nav {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(0,0,0,0.5);
      padding: 10px;
      border-radius: 50%;
      cursor: pointer;
    }
    .lightbox-nav:hover {
      background: rgba(0,0,0,0.8);
    }
    .left-nav { left: 20px; }
    .right-nav { right: 20px; }

    .fade-in-logo {
    animation: fadeInLogo 0.8s ease-out forwards;
  }

  @keyframes fadeInLogo {
    0% {
      opacity: 0;
      transform: scale(0.5) rotate(-15deg);
    }
    100% {
      opacity: 1;
      transform: scale(1) rotate(0deg);
    }
  }

  @keyframes fadeInMenu {
    from { opacity: 0; transform: scale(0.95); }
    to { opacity: 1; transform: scale(1); }
  }

  .animate-fade-in {
    animation: fadeInMenu 0.3s ease-out;
  }

  #mobile-menu {
    backdrop-filter: blur(5px); /* Para que el fondo detrás del menú se vea ligeramente borroso */
  }
  </style>
  
<body class="bg-gray-100">

    <!-- Header -->
<!-- Header con menú hamburguesa -->
<header class="bg-white shadow-md py-4">
    <div class="container mx-auto px-6 flex justify-between items-center">
      <!-- Logo + Frase -->
      <div class="flex items-center space-x-3">
        <img src="https://img.icons8.com/ios-filled/50/suitcase.png" alt="Icono Maleta" class="w-8 h-8 fade-in-logo">
        <span class="text-xl font-bold text-indigo-600">Rentas Cortas</span>
      </div>
  
      <!-- Botón Hamburguesa -->
      <button id="menu-toggle" class="md:hidden text-gray-600 focus:outline-none">
        <svg id="menu-icon" class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path id="menu-icon-path" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="M4 6h16M4 12h16M4 18h16"></path>
        </svg>
      </button>
  
      <!-- Menú Desktop -->
      <nav class="hidden md:flex space-x-6 text-gray-700 font-semibold">
        <a href="#sobre-nosotros" class="hover:text-indigo-600">Sobre Nosotros</a>
        <a href="#contacto" class="hover:text-indigo-600">Contacto</a>
        <a href="https://wa.me/56931962245" target="_blank" class="hover:text-green-500">WhatsApp</a>
      </nav>
    </div>
  </header>
  
<!-- Menú Popup para Móviles Mejorado -->
<div id="mobile-menu" class="fixed inset-0 bg-white bg-opacity-95 hidden flex flex-col items-center justify-center z-50 rounded-lg shadow-lg animate-fade-in">
    <button id="close-menu" class="absolute top-6 right-6 text-gray-600 hover:text-red-500 text-3xl font-bold">&times;</button>
    <nav class="flex flex-col items-center space-y-8 text-gray-700 text-xl font-semibold mt-10">
      <a href="#sobre-nosotros" class="flex items-center space-x-2 hover:text-indigo-600" onclick="closeMobileMenu()">
        <span>🏠</span> <span>Sobre Nosotros</span>
      </a>
      <a href="#contacto" class="flex items-center space-x-2 hover:text-indigo-600" onclick="closeMobileMenu()">
        <span>📞</span> <span>Contacto</span>
      </a>
      <a href="https://wa.me/56931962245" target="_blank" class="flex items-center space-x-2 hover:text-green-500" onclick="closeMobileMenu()">
        <span>💬</span> <span>WhatsApp</span>
      </a>
    </nav>
  </div>
  

  <!-- Script para abrir/cerrar menú móvil -->
  <script>
    const toggle = document.getElementById('menu-toggle');
    const mobileMenu = document.getElementById('mobile-menu');
    const closeMenuBtn = document.getElementById('close-menu');
    const iconPath = document.getElementById('menu-icon-path');
  
    toggle.addEventListener('click', () => {
      mobileMenu.classList.remove('hidden');
      iconPath.setAttribute('d', 'M6 18L18 6M6 6l12 12'); // cambia a X
    });
  
    closeMenuBtn.addEventListener('click', closeMobileMenu);
  
    function closeMobileMenu() {
      mobileMenu.classList.add('hidden');
      iconPath.setAttribute('d', 'M4 6h16M4 12h16M4 18h16'); // vuelve hamburguesa
    }
  </script>

<!-- Banner -->
<section class="py-0">
  <div class="container mx-auto rounded-lg overflow-hidden bg-cover bg-center" style="background-image: url('./cmpy/IMG_5407.jpg');">
    <div class="px-4 py-16 text-center bg-black bg-opacity-40">
      <h1 class="text-4xl md:text-6xl font-bold mb-4 text-white">Home Rent</h1>
      <p class="text-lg md:text-2xl mb-6 text-white">Encuentra el sitio perfecto para tu próxima estadía</p>
    </div>
  </div>
</section>

<!-- Filtros -->
<div class="container mx-auto px-4 py-6 flex flex-wrap gap-4 justify-center">
  <div>
    <label for="capacity-filter" class="mr-2 font-semibold">Personas:</label>
    <select id="capacity-filter" class="p-2 rounded border">
      <option value="">Todas</option>
      <option value="1">1</option>
      <option value="2">2</option>
      <option value="3">3</option>
      <option value="4">4+</option>
    </select>
  </div>
  <div>
    <label for="price-filter" class="mr-2 font-semibold">Precio:</label>
    <select id="price-filter" class="p-2 rounded border">
      <option value="">Todos</option>
      <option value="30000">Hasta 30,000</option>
      <option value="60000">Hasta 60,000</option>
      <option value="90000">Hasta 90,000</option>
    </select>
  </div>
  <button id="reset-filters" class="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600">Restablecer</button>
</div>

<!-- Galería -->
<div id="gallery" class="container mx-auto px-4 py-8 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6"></div>

<!-- Popup Reutilizable -->
<div id="popup" class="fixed inset-0 bg-black bg-opacity-70 hidden z-50 flex items-center justify-center p-4 overflow-auto">
  <div class="bg-white p-6 rounded shadow-lg max-w-2xl w-full relative">
    <button onclick="closePopup()" class="absolute top-2 right-2 text-2xl">&times;</button>
    <div id="popup-content"></div>
  </div>
</div>

<!-- Lightbox -->
<div id="lightbox" class="fixed inset-0 bg-black bg-opacity-80 hidden justify-center items-center z-50">
  <div class="relative w-full h-full flex items-center justify-center">
    <button onclick="prevImage()" class="lightbox-nav left-nav text-white text-3xl">&#10094;</button>
    <img id="lightbox-img" class="max-h-full max-w-full">
    <button onclick="nextImage()" class="lightbox-nav right-nav text-white text-3xl">&#10095;</button>
    <button onclick="closeLightbox()" class="absolute top-4 right-4 text-white text-2xl">&times;</button>
  </div>
</div>

<script>
  let departamentos = [];
  let currentImageIndex = 0;
  let currentImageList = [];

  fetch('./data/info.json')
    .then(response => response.json())
    .then(data => {
      departamentos = data;
      renderDepartments(departamentos);
    });

  function renderDepartments(data) {
    const gallery = document.getElementById('gallery');
    gallery.innerHTML = '';
    data.forEach(depto => {
      const card = document.createElement('div');
      card.className = 'card bg-white rounded shadow overflow-hidden transform hover:scale-105 transition-all fade-in';
      card.innerHTML = `
        <img src="${depto.imagen}" alt="${depto.titulo}" loading="lazy" class="w-full h-48 object-cover">
        <div class="p-4">
          <h2 class="font-bold text-lg mb-2">${depto.titulo}</h2>
          <p class="text-gray-600 text-sm mb-1">${depto.ubicacion}</p>
          <p class="text-gray-600 text-sm mb-1">👥 ${depto.capacidad} personas</p>
          <p class="text-indigo-600 font-semibold">Desde $${parseInt(depto.precio).toLocaleString('es-CL')}</p>
        </div>
      `;
      card.addEventListener('click', () => openPopup(depto.id));
      gallery.appendChild(card);
    });
  }

  function openPopup(id) {
  const depto = departamentos.find(d => d.id == id);
  if (!depto) {
    console.error('Departamento no encontrado para id:', id);
    return;
  }
  
  console.log('Abriendo popup para:', depto);

  const popupContent = document.getElementById('popup-content');
  
  const fullImageList = depto.imagenes?.map(img => `${depto.directorio}${img}`) || [];
  currentImageList = fullImageList;
  
  if (fullImageList.length === 0) {
    console.warn('No hay imágenes disponibles para este departamento.');
  }

  popupContent.innerHTML = `
  <h2 class="text-2xl font-bold mb-4">${depto.titulo}</h2>
  ${fullImageList.length > 0 ? `
    <div class="flex overflow-x-auto space-x-4 mb-4 popup-thumbnails">
      ${fullImageList.map((img, i) => `
        <img src="${img}" loading="lazy" class="h-40 cursor-pointer" onclick="openLightbox(currentImageList, ${i})">
      `).join('')}
    </div>
  ` : `<p class="mb-4 text-red-500">No hay imágenes disponibles para este departamento.</p>`}
  <p class="mb-4">${depto.descripcion}</p>
    <a href="${depto.link}" target="_blank" class="inline-flex items-center bg-red-500 hover:bg-red-600 text-white font-semibold py-2 px-4 rounded transition">
    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/6/69/Airbnb_Logo_Bélo.svg/20px-Airbnb_Logo_Bélo.svg.png" alt="Airbnb" class="w-5 h-5 mr-2">
    Ver en Airbnb
    </a>
`;

  document.getElementById('popup').classList.remove('hidden');
  setTimeout(() => {
    document.getElementById('popup').classList.add('show');
  }, 10);
  document.body.style.overflow = 'hidden';
}


  function closePopup() {
    const popup = document.getElementById('popup');
    popup.classList.remove('show');
    setTimeout(() => popup.classList.add('hidden'), 300);
    document.body.style.overflow = 'auto';
  }

  function applyFilters() {
    const selectedCapacity = parseInt(document.getElementById('capacity-filter').value);
    const selectedPrice = parseInt(document.getElementById('price-filter').value);

    const filtered = departamentos.filter(d => {
      const matchesCapacity = isNaN(selectedCapacity) || parseInt(d.capacidad) >= selectedCapacity;
      const matchesPrice = isNaN(selectedPrice) || parseInt(d.precio) <= selectedPrice;
      return matchesCapacity && matchesPrice;
    });

    renderDepartments(filtered);
  }

  document.getElementById('capacity-filter').addEventListener('change', applyFilters);
  document.getElementById('price-filter').addEventListener('change', applyFilters);
  document.getElementById('reset-filters').addEventListener('click', () => {
    document.getElementById('capacity-filter').value = '';
    document.getElementById('price-filter').value = '';
    renderDepartments(departamentos);
  });

  function openLightbox(images, index) {
    currentImageList = images;
    currentImageIndex = index;
    updateLightboxImage();
    document.getElementById('lightbox').classList.remove('hidden');
    setTimeout(() => document.getElementById('lightbox').classList.add('show'), 10);
  }

  function closeLightbox() {
    const lightbox = document.getElementById('lightbox');
    lightbox.classList.remove('show');
    setTimeout(() => lightbox.classList.add('hidden'), 300);
  }

  function prevImage() {
    currentImageIndex = (currentImageIndex - 1 + currentImageList.length) % currentImageList.length;
    updateLightboxImage();
  }

  function nextImage() {
    currentImageIndex = (currentImageIndex + 1) % currentImageList.length;
    updateLightboxImage();
  }

  function updateLightboxImage() {
    const img = document.getElementById('lightbox-img');
    img.style.opacity = 0;
    setTimeout(() => {
      img.src = currentImageList[currentImageIndex];
      img.style.opacity = 1;
    }, 200);
  }
  // Cierra popup si haces click fuera del contenido
document.getElementById('popup').addEventListener('click', function (e) {
  if (e.target === this) {
    closePopup();
  }
});

</script>
<!-- Footer -->
<footer class="bg-gray-200 text-center text-gray-600 text-sm py-4 mt-8">
    © 2025 Home Rent. Todos los derechos reservados.
  </footer>
  
</body>
</html>
